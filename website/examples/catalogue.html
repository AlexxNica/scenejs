<div id="page" class="buffered-page-invisible">
    <div id="content">
        <h1>Examples</h1>

        <div id="intro">
            <p>These are live, tweakable SceneJS examples, ready to run right here in the browser.</p>

            <p>To run these, you'll need a browser that supports WebGL - <a href="http://learningwebgl.com/blog/?p=11">here's
                how to set one up</a>. </b></p>
        </div>
        <div id="main">
            <div id="catalogue">
                <div id="index"></div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    var revealThisPage = function() {
        $("#page").removeClass().addClass("buffered-page-visible");
    };

    function createCatalogue(cat) {

        /* Create catalogue
         */
        var html = [];
        for (var i = 0; i < cat.categories.length; i++) {
            var category = cat.categories[i];
            html.push('<div class="catalogue-category">');
            html.push('<h2>');
            html.push(category.title);
            html.push('</h2>');
            html.push('<div class="catalogue-entry-list">');
            if (category.entries) {
                for (var j = 0; j < category.entries.length; j++) {
                    var entry = category.entries[j];
                    html.push('<div class="catalogue-entry">');
                    html.push('<div class="catalogue-entry-text">');
                    html.push('<a id="catalogue-entry-link' + i + '-' + j + '">');
                    html.push(entry.title);
                    html.push("</a>");
                    html.push("</div>");
                    html.push("</div>");
                }
            }
            html.push('</div></div>');
        }
        $("#catalogue").html(html.join(""));


        /* Attach handler to entries
         */
        var openEntry = function(id) {
            $("#example_id").text(id);
            $("#playroom-inner").load("./examples/example.html");
        };
        for (var i = 0; i < cat.categories.length; i++) {
            var category = cat.categories[i];
            if (category.entries) {
                for (var j = 0; j < category.entries.length; j++) {
                    var entry = category.entries[j];
                    $("#catalogue-entry-link" + i + "-" + j).click(
                            (function(id) {   //  delegate
                                return function() {
                                    openEntry(id);
                                };
                            })(entry.id));
                }
            }
        }
    }

    /* Load catalogue
     */
    try {
        $.ajax({
            url: "./examples/repository/catalogue.js",
            success: function(data) {
                var catalogue = null;
                eval("catalogue=" + data);
                createCatalogue(catalogue);
                revealThisPage();
            }});
    } catch (e) {
        jAlert("The Examples section seems to be down at the moment..please try again later.", "Examples failed to load", function() {
        });
    }
</script>
